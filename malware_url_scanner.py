import streamlit as st
import requests

def check_google_safe_browsing(url):
    safe_browsing_url = f"https://transparencyreport.google.com/safe-browsing/search?url={url}"
    return f"Check URL on Google Safe Browsing: [Click Here]({safe_browsing_url})"

def check_urlhaus(url):
    urlhaus_api = "https://urlhaus-api.abuse.ch/v1/url/"
    response = requests.post(urlhaus_api, data={"url": url})
    
    if response.status_code == 200:
        result = response.json()
        if result.get("query_status") == "ok":
            return f"⚠️ **Malicious URL Detected!** \n\n {result}"
        else:
            return "✅ This URL is not listed in URLHaus."
    return "❌ Error checking URLHaus."
